<!doctype html>
<html>
<head>
    <title>Ham Radio Lookup</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Page</title>
    <style>
        table {
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 4px;
        }
    </style>
</head>
<body>
    <h1>Ham Radio License Lookup</h1>
    <form method="get">
        <label>Call Sign: <input type="text" name="call_sign" value="{{ params.call_sign if (params.call_sign is defined and params.call_sign is not none) else '' }}"></label><br>
        <label>First Name: <input type="text" name="first_name" value="{{ params.first_name if (params.first_name is defined and params.first_name is not none) else '' }}"></label><br>
        <label>Last Name: <input type="text" name="last_name" value="{{ params.last_name if (params.last_name is defined and params.last_name is not none) else '' }}"></label><br>
        <label>City: <input type="text" name="city" value="{{ params.city if (params.city is defined and params.city is not none) else '' }}"></label><br>
        <label>State: <input type="text" name="state" value="{{ params.state if (params.state is defined and params.state is not none) else '' }}"></label><br>

        <p>License Status:</p>
        {% for status in ['A', 'C', 'E', 'L', 'P', 'T', 'X'] %}
            <label><input type="checkbox" name="license_status" value="{{ status }}" {% if status in request.args.getlist('license_status') or (not request.args and status == 'A') %}checked{% endif %}> {{ status }}</label>
        {% endfor %}
        <br>

        <p>Operator Class:</p>
        {% for op_class in ['A', 'E', 'G', 'N', 'P', 'T'] %}
            <label><input type="checkbox" name="operator_class" value="{{ op_class }}" {% if op_class in request.args.getlist('operator_class') or (not request.args and op_class in ['T', 'G', 'E']) %}checked{% endif %}> {{ op_class }}</label>
        {% endfor %}
        <br>

        <input type="submit" value="Search">
    </form>

    {% if results %}
        <h2>Results</h2>
        <table>
            <tr>
                <th>Call Sign</th>
                <th>License Status</th>
                <th>Operator Class</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>City</th>
                <th>State</th>
            </tr>
            {% for row in results %}
                <tr>
                    <td>{{ row['call_sign'] }}</td>
                    <td>{{ row['license_status'] }}</td>
                    <td>{{ row['operator_class'] }}</td>
                    <td>{{ row['first_name'].title() }}</td>
                    <td>{{ row['last_name'].title() }}</td>
                    <td>{{ row['city'].title() }}</td>
                    <td>{{ row['state'] }}</td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}
</body>
</html>
